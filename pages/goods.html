<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–¢–æ–≤–∞—Ä—ã</title>
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <style>
    /* ===== –ë–ê–ó–û–í–´–ï –°–¢–ò–õ–ò ===== */
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 0;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
    }

    /* ===== –ö–û–ù–¢–ï–ô–ù–ï–† –°–¢–†–ê–ù–ò–¶–´ ===== */
    .page-container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      min-height: 100vh;
      box-shadow: 0 0 30px rgba(0, 0, 0, 0.1);
    }

    /* ===== –®–ê–ü–ö–ê ===== */
    .header {
      background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
      color: white;
      text-align: center;
      padding: 30px;
      font-size: 28px;
      font-weight: 300;
      letter-spacing: 2px;
    }

    /* ===== –ù–ê–í–ò–ì–ê–¶–ò–Ø ===== */
    .nav {
      background: #2c3e50;
      padding: 20px 0;
    }

    .nav-list {
      list-style: none;
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
      gap: 25px;
    }

    .nav-item {
      margin: 0;
    }

    .nav-link {
      color: white;
      text-decoration: none;
      padding: 12px 25px;
      border-radius: 25px;
      transition: all 0.3s ease;
      font-weight: 500;
    }

    .nav-link:hover {
      background: rgba(255, 255, 255, 0.1);
      transform: translateY(-2px);
    }

    /* ===== –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ù–¢ ===== */
    .content {
      padding: 40px;
      max-width: 900px;
      margin: 0 auto;
    }

    /* ===== –ö–ù–û–ü–ö–ò ===== */
    .buttons {
      display: flex;
      gap: 15px;
      margin-bottom: 30px;
      justify-content: center;
    }

    button {
      padding: 12px 25px;
      border: none;
      border-radius: 25px;
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      color: white;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 600;
      box-shadow: 0 4px 15px rgba(79, 172, 254, 0.3);
    }

    button:hover:not(:disabled) {
      transform: translateY(-3px);
      box-shadow: 0 6px 20px rgba(79, 172, 254, 0.4);
    }

    button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    /* ===== –°–ü–ò–°–û–ö –¢–û–í–ê–†–û–í ===== */
    .products-list {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 25px;
    }

    .product {
      background: white;
      color: #2c3e50;
      border-radius: 15px;
      padding: 20px;
      text-align: center;
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      border-left: 4px solid #667eea;
    }

    .product:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
    }

    .product img {
      width: 100%;
      height: 200px;
      object-fit: contain;
      border-radius: 10px;
      margin-bottom: 15px;
      border: 2px solid #f0f0f0;
      background: #f8f9fa;
      padding: 10px;
    }

    .product h3 {
      margin: 0 0 15px 0;
      font-size: 18px;
      min-height: 50px;
      overflow: hidden;
      font-weight: 600;
      line-height: 1.4;
    }

    .product p {
      font-size: 20px;
      font-weight: bold;
      color: #2c3e50;
      margin: 15px 0;
    }

    .product a {
      display: inline-block;
      margin-top: 10px;
      padding: 10px 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #fff;
      text-decoration: none;
      border-radius: 25px;
      transition: all 0.3s ease;
      font-weight: 500;
    }

    .product a:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 10px rgba(102, 126, 234, 0.4);
    }

    /* ===== –°–ö–ï–õ–ï–¢–û–ù–´ –ó–ê–ì–†–£–ó–ö–ò ===== */
    .skeleton-loading {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 25px;
    }

    .skeleton-product {
      background: white;
      border-radius: 15px;
      padding: 20px;
      text-align: center;
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
    }

    .skeleton-image {
      width: 100%;
      height: 200px;
      border-radius: 10px;
      margin-bottom: 15px;
      background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
      background-size: 200% 100%;
      animation: loading 1.5s infinite;
    }

    .skeleton-text {
      height: 20px;
      background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
      background-size: 200% 100%;
      animation: loading 1.5s infinite;
      border-radius: 4px;
      margin-bottom: 10px;
    }

    .skeleton-text.short {
      width: 60%;
      margin: 0 auto 10px;
    }

    .skeleton-text.medium {
      width: 80%;
    }

    @keyframes loading {
      0% {
        background-position: 200% 0;
      }
      100% {
        background-position: -200% 0;
      }
    }

    /* ===== –°–¢–ê–¢–£–° –ö–û–†–ó–ò–ù–´ ===== */
    .cart-status {
      position: fixed;
      top: 20px;
      right: 20px;
      background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
      color: white;
      padding: 10px 15px;
      border-radius: 20px;
      font-weight: 600;
      box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4);
      z-index: 1000;
    }

    /* ===== –°–û–û–ë–©–ï–ù–ò–Ø ===== */
    .loading-message {
      text-align: center;
      font-size: 18px;
      color: #2c3e50;
      padding: 40px 0;
    }

    .error-message {
      text-align: center;
      color: #e74c3c;
      padding: 20px;
      background: #ffeaea;
      border-radius: 10px;
      margin: 20px 0;
      border: 1px solid #e74c3c;
    }

    .success-message {
      text-align: center;
      color: #27ae60;
      padding: 20px;
      background: #e8f6ef;
      border-radius: 10px;
      margin: 20px 0;
      border: 1px solid #27ae60;
    }

    /* ===== –§–£–¢–ï–† ===== */
    .footer {
      background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
      color: white;
      text-align: center;
      padding: 30px;
      margin-top: 50px;
    }

    /* ===== –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ ===== */
    @media (max-width: 768px) {
      .nav-list {
        flex-wrap: wrap;
      }
      
      .products-list, .skeleton-loading {
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      }
      
      .buttons {
        flex-direction: column;
        align-items: center;
      }
      
      .cart-status {
        top: 10px;
        right: 10px;
        font-size: 14px;
      }
      {
        background: white;
        margin: 0;
        padding: 0;
    }
    }
  </style>
  <link rel="icon" href="../images/favicon.ico" type="image/x-icon">
</head>
<body>
  <div class="page-container">
    <div class="header">–ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤</div>
    
    <div class="nav">
      <ul class="nav-list">
        <li class="nav-item"><a class="nav-link" href="../index.html">–ì–ª–∞–≤–Ω–∞—è</a></li>
        <li class="nav-item"><a class="nav-link" href="news.html">–ù–æ–≤–æ—Å—Ç–∏</a></li>
        <li class="nav-item"><a class="nav-link" href="practices.html">–ü—Ä–∞–∫—Ç–∏–∫–∏</a></li>
        <li class="nav-item"><a class="nav-link" href="goods.html" style="background: rgba(255,255,255,0.2);">–¢–æ–≤–∞—Ä—ã</a></li>
        <li class="nav-item"><a class="nav-link" href="contacts.html">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
      </ul>
    </div>
    
    <div class="content">
      <div id="app">
        <!-- –°—Ç–∞—Ç—É—Å –∫–æ—Ä–∑–∏–Ω—ã -->
        <div v-if="cartCount > 0" class="cart-status">
          üõí {{ cartCount }} —Ç–æ–≤–∞—Ä(–æ–≤)
        </div>

        <div class="buttons">
          <button @click="loadProducts" :disabled="loading">
            {{ loading ? '–ó–∞–≥—Ä—É–∑–∫–∞...' : '–û–±–Ω–æ–≤–∏—Ç—å —Ç–æ–≤–∞—Ä—ã' }}
          </button>
          <button @click="loadProductsFromCache" :disabled="loading">
            –ò–∑ –∫—ç—à–∞
          </button>
          <button @click="goBack">–ù–∞–∑–∞–¥</button>
        </div>

        <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ -->
        <div v-if="error" class="error-message">
          {{ error }}
          <br>
          <button @click="loadProductsFromCache" style="margin-top: 10px; padding: 8px 16px;">
            –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ –∫—ç—à–∞
          </button>
        </div>

        <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ -->
        <div v-if="successMessage" class="success-message">
          {{ successMessage }}
        </div>

        <!-- –°–∫–µ–ª–µ—Ç–æ–Ω—ã –∑–∞–≥—Ä—É–∑–∫–∏ -->
        <div v-if="loading && products.length === 0" class="skeleton-loading">
          <div v-for="n in 8" :key="n" class="skeleton-product">
            <div class="skeleton-image"></div>
            <div class="skeleton-text"></div>
            <div class="skeleton-text short"></div>
            <div class="skeleton-text medium"></div>
          </div>
        </div>

        <!-- –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ -->
        <div v-else-if="products.length" class="products-list">
          <div v-for="product in products" :key="product.id" class="product">
            <img 
              :src="product.image" 
              :alt="product.name"
              @load="onImageLoad(product.id)"
              @error="onImageError(product.id)"
              loading="lazy"
            >
            <h3>{{ product.name }}</h3>
            <p>{{ formatPrice(product.price) }}</p>
            <a href="#" @click.prevent="addToCart(product)">
              {{ product.addingToCart ? '–î–æ–±–∞–≤–ª—è–µ—Ç—Å—è...' : '–í –∫–æ—Ä–∑–∏–Ω—É' }}
            </a>
          </div>
        </div>
        
        <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ –∑–∞–≥—Ä—É–∑–∫–µ -->
        <div v-else class="loading-message">
          <p>–¢–æ–≤–∞—Ä—ã –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã. –ù–∞–∂–º–∏—Ç–µ "–û–±–Ω–æ–≤–∏—Ç—å —Ç–æ–≤–∞—Ä—ã"</p>
        </div>
      </div>
    </div>
    
    <div class="footer">
      <p>–§—É—Ç–µ—Ä</p>
    </div>
  </div>

  <script>
    const { createApp } = Vue;
    
    createApp({
      data() {
        return {
          products: [],
          cartCount: 0,
          loading: false,
          error: null,
          successMessage: null
        }
      },
      methods: {
        async loadProducts() {
          this.loading = true;
          this.error = null;
          this.successMessage = null;
          
          try {
            console.log('–ù–∞—á–∞–ª–æ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤...');
            
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º –±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã–π endpoint
            const response = await fetch('https://fakestoreapi.com/products?limit=8');
            
            if (!response.ok) {
              throw new Error(`HTTP error! status: ${response.status}`);
            }
            
            const data = await response.json();
            console.log('–î–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–µ–Ω—ã:', data);

            if (!data || data.length === 0) {
              throw new Error('–ü–æ–ª—É—á–µ–Ω –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤');
            }

            // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ
            const processedProducts = this.shuffleArray(data).map(item => ({
              id: item.id,
              name: item.title && item.title.length > 50 ? item.title.substring(0, 50) + '...' : item.title,
              price: item.price,
              image: item.image,
              imageLoaded: false,
              addingToCart: false
            }));

            this.products = processedProducts;
            this.cacheProducts(processedProducts);
            this.successMessage = `–ó–∞–≥—Ä—É–∂–µ–Ω–æ ${processedProducts.length} —Ç–æ–≤–∞—Ä–æ–≤`;
            
          } catch (err) {
            console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ç–æ–≤–∞—Ä–æ–≤:", err);
            this.error = '–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ç–æ–≤–∞—Ä—ã. ' + err.message;
            
            // –ü—Ä–æ–±—É–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ –∫—ç—à–∞
            const cached = this.getCachedProducts();
            if (cached.length > 0) {
              this.products = cached;
              this.error += ' –ü–æ–∫–∞–∑–∞–Ω—ã –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.';
            }
          } finally {
            this.loading = false;
          }
        },

        loadProductsFromCache() {
          const cachedProducts = this.getCachedProducts();
          if (cachedProducts.length > 0) {
            this.products = cachedProducts;
            this.successMessage = `–ó–∞–≥—Ä—É–∂–µ–Ω–æ ${cachedProducts.length} —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ –∫—ç—à–∞`;
            this.error = null;
          } else {
            this.error = '–í –∫—ç—à–µ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö. –°–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ç–æ–≤–∞—Ä—ã.';
          }
        },

        shuffleArray(array) {
          const newArray = [...array];
          for (let i = newArray.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
          }
          return newArray;
        },

        cacheProducts(products) {
          try {
            localStorage.setItem('cachedProducts', JSON.stringify({
              data: products,
              timestamp: Date.now()
            }));
            console.log('–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –∫—ç—à');
          } catch (e) {
            console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –∫—ç—à:', e);
          }
        },

        getCachedProducts() {
          try {
            const cached = localStorage.getItem('cachedProducts');
            if (cached) {
              const { data, timestamp } = JSON.parse(cached);
              // –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫—ç—à —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –æ–Ω —Å–≤–µ–∂–µ–µ 24 —á–∞—Å–æ–≤
              if (Date.now() - timestamp < 24 * 60 * 60 * 1000) {
                console.log('–ó–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ –∏–∑ –∫—ç—à–∞');
                return data.map(item => ({
                  ...item,
                  imageLoaded: false,
                  addingToCart: false
                }));
              }
            }
          } catch (e) {
            console.warn('–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è –∫—ç—à–∞:', e);
          }
          return [];
        },

        onImageLoad(productId) {
          const product = this.products.find(p => p.id === productId);
          if (product) {
            product.imageLoaded = true;
          }
        },

        onImageError(productId) {
          const product = this.products.find(p => p.id === productId);
          if (product) {
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º placeholder –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            product.image = 'https://via.placeholder.com/300x200/667eea/ffffff?text=No+Image';
            product.imageLoaded = true;
          }
        },

        formatPrice(price) {
          return new Intl.NumberFormat('ru-RU', {
            style: 'currency',
            currency: 'USD'
          }).format(price);
        },

        async addToCart(product) {
          if (product.addingToCart) return;
          
          product.addingToCart = true;
          
          // –ò–º–∏—Ç–∞—Ü–∏—è –∑–∞–¥–µ—Ä–∂–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ—Ä–∑–∏–Ω—É
          await new Promise(resolve => setTimeout(resolve, 500));
          
          this.cartCount++;
          product.addingToCart = false;
          
          this.showNotification(`–¢–æ–≤–∞—Ä "${product.name}" –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É!`);
        },

        showNotification(message) {
          // –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
          const notification = document.createElement('div');
          notification.style.cssText = `
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: #2ecc71;
            color: white;
            padding: 12px 20px;
            border-radius: 25px;
            box-shadow: 0 4px 15px rgba(46, 204, 113, 0.4);
            z-index: 1000;
            font-weight: 500;
          `;
          notification.textContent = message;
          document.body.appendChild(notification);
          
          setTimeout(() => {
            if (notification.parentNode) {
              notification.parentNode.removeChild(notification);
            }
          }, 3000);
        },

        goBack() {
          window.history.back();
        }
      },
      mounted() {
        console.log('–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω');
        
        // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –∫–æ—Ä–∑–∏–Ω—ã –∏–∑ localStorage
        try {
          const savedCartCount = localStorage.getItem('cartCount');
          if (savedCartCount) {
            this.cartCount = parseInt(savedCartCount);
          }
        } catch (e) {
          console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É:', e);
        }

        // –ü—ã—Ç–∞–µ–º—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ –∫—ç—à–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        const cachedProducts = this.getCachedProducts();
        if (cachedProducts.length > 0) {
          this.products = cachedProducts;
          this.successMessage = '–ó–∞–≥—Ä—É–∂–µ–Ω—ã –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã';
        } else {
          // –ï—Å–ª–∏ –∫—ç—à–∞ –Ω–µ—Ç, –∑–∞–≥—Ä—É–∂–∞–µ–º —Å —Å–µ—Ä–≤–µ—Ä–∞
          this.loadProducts();
        }
      },
      watch: {
        cartCount(newCount) {
          // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å—á–µ—Ç—á–∏–∫ –∫–æ—Ä–∑–∏–Ω—ã –≤ localStorage
          try {
            localStorage.setItem('cartCount', newCount.toString());
          } catch (e) {
            console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É:', e);
          }
        }
      }
    }).mount('#app');
  </script>
</body>
</html>